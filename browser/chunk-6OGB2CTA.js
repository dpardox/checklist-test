import{a as re,c as ne,d as oe,e as B,f as ae,g as M,i as se}from"./chunk-RZE5UB53.js";import{a as le,b as pe,c as ce,d as me,e as de,f as ue,g as fe,h as ke,i as he}from"./chunk-DULBAHTO.js";import{$ as Q,$a as E,B as U,D as p,G as m,J as W,L as q,N as f,P as z,R as J,S as K,T as n,U as a,V as k,Y as V,Z as d,_ as h,_a as D,a as A,aa as X,b as O,ba as s,c,ca as y,da as b,fa as Y,g as C,ga as u,ha as g,ia as Z,j as R,k as H,na as ee,o as G,oa as _,pa as te,qa as F,r as l,ta as ie,u as L,v as S,w as T}from"./chunk-VJZCMKZA.js";var x=class r{firestore=l(re);authService=l(D);create(t){return c(this,null,function*(){let e=yield C(this.authService.user$);if(!e)throw new Error("User not authenticated");let i=new Date,o=B(this.firestore,`users/${e.uid}/tasks`);return oe(o,O(A({},t),{createdAt:i}))})}getAll(){return this.authService.user$.pipe(R(t=>!!t),H(t=>{let e=B(this.firestore,`users/${t.uid}/tasks`);return ne(e,{idField:"id"})}))}update(t,e){return c(this,null,function*(){let i=yield C(this.authService.user$);if(!i)throw new Error("User not authenticated");let o=M(this.firestore,`users/${i.uid}/tasks/${t}`);return se(o,e)})}delete(t){return c(this,null,function*(){let e=yield C(this.authService.user$);if(!e)throw new Error("User not authenticated");let i=M(this.firestore,`users/${e.uid}/tasks/${t}`);return ae(i)})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})};var $=class r{transform(t){if(!t||t.length===0)return[];let e=t.filter(o=>!o.done).sort(this.sortByDate),i=t.filter(o=>o.done).sort(this.sortByDate);return[...e,...i]}sortByDate(t,e){return e.createdAt.toDate().getTime()-t.createdAt.toDate().getTime()}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=W({name:"taskSort",type:r,pure:!0})};var N=class r{authService=l(D);router=l(ie);user$=this.authService.user$;signOut(){return c(this,null,function*(){yield this.authService.signOut(),this.router.navigate(["/sign-in"])})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=m({type:r,selectors:[["app-header"]],decls:12,vars:3,consts:[[1,"flex","items-center","flex-col","sm:flex-row","sm:justify-between","py-5"],[1,"flex","flex-col","items-end","py-3"],[1,"text-gray-600","font-semibold","text-2xl","mb-1","leading-none"],[1,"text-xs","leading-none"],[1,"flex","sm:flex-col","items-end","gap-2","sm:gap-0","py-3"],[1,"text-gray-500"],[1,"text-blue-500","cursor-pointer",3,"click"]],template:function(e,i){if(e&1&&(n(0,"header",0)(1,"div",1)(2,"h2",2),s(3,"Checklist Test"),a(),n(4,"span",3),s(5,"By dpardox"),a()(),n(6,"div",4)(7,"div",5),s(8),u(9,"async"),a(),n(10,"a",6),d("click",function(){return i.signOut()}),s(11,"Sign out"),a()()()),e&2){let o;p(8),y((o=g(9,1,i.user$))==null?null:o.email)}},dependencies:[F,_],encapsulation:2})};var ve=["*"],I=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=m({type:r,selectors:[["app-web"]],ngContentSelectors:ve,decls:3,vars:0,consts:[[1,"mx-auto","max-w-3xl","w-full","px-2","sm:px-5"]],template:function(e,i){e&1&&(Q(),n(0,"div",0),k(1,"app-header"),X(2),a())},dependencies:[N],encapsulation:2})};var P=class r{task=null;formBuilder=l(ke);taskService=l(x);toastService=l(E);ngOnChanges(t){t.task&&this.taskForm.patchValue(this.task||{})}get idControl(){return this.taskForm.get("id")}taskForm=this.formBuilder.nonNullable.group({id:[""],title:["",[pe.required]],description:[""]});submitTask(){return c(this,null,function*(){if(this.taskForm.invalid)return;let{id:t,title:e,description:i}=this.taskForm.value;try{t?(yield this.taskService.update(t,{title:e,description:i}),this.toastService.show("Task updated successfully!")):(yield this.taskService.create({title:e,description:i}),this.toastService.show("Task created successfully!")),this.taskForm.reset()}catch{this.toastService.show("Error creating task");return}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=m({type:r,selectors:[["app-task-form"]],inputs:{task:"task"},features:[L],decls:7,vars:2,consts:[[3,"ngSubmit","formGroup"],[1,"flex","flex-col","sm:flex-row","justify-between","mb-6","gap-3","sm:items-start"],["type","text","placeholder","Title","formControlName","title",1,"py-2","px-3","rounded-md","bg-gray-50","placeholder-gray-400","outline-none","block","flex-1"],["rows","3","placeholder","Description","formControlName","description",1,"py-2","px-3","rounded-md","bg-gray-50","placeholder-gray-400","outline-none","block","flex-2"],["type","submit",1,"bg-indigo-500","px-4","py-2","rounded-md","text-white","tracking-wide","cursor-pointer"]],template:function(e,i){e&1&&(n(0,"form",0),d("ngSubmit",function(){return i.submitTask()}),n(1,"div",1),k(2,"input",2),n(3,"textarea",3),s(4,"    "),a(),n(5,"button",4),s(6),a()()()),e&2&&(f("formGroup",i.taskForm),p(6),b(" ",i.idControl!=null&&i.idControl.value?"Update":"New"," "))},dependencies:[he,de,le,ce,me,ue,fe],encapsulation:2})};var ye=r=>({"bg-gray-50 line-through opacity-50":r}),be=(r,t)=>t.id;function we(r,t){if(r&1){let e=V();n(0,"div",14)(1,"button",15),d("click",function(){S(e);let o=h().$implicit,v=h();return T(v.editTask(o))}),s(2," Edit "),a(),n(3,"button",16),d("click",function(){S(e);let o=h().$implicit,v=h();return T(v.deleteTask(o.id))}),s(4," Remove "),a()()}}function Ce(r,t){if(r&1){let e=V();n(0,"tr",4)(1,"td",7)(2,"div",8)(3,"input",9),d("change",function(){let o=S(e).$implicit,v=h();return T(v.toggleDone(o))}),a(),n(4,"div",10)(5,"p",11),s(6),a(),n(7,"p",12),s(8),a(),n(9,"p",13),s(10),u(11,"date"),a(),q(12,we,5,0,"div",14),a()()()()}if(r&2){let e=t.$implicit;f("ngClass",Y(9,ye,e==null?null:e.done)),p(3),f("checked",e==null?null:e.done),p(3),y(e.title),p(2),y(e.description),p(2),b(" ",Z(11,6,e.createdAt.toDate(),"medium")," "),p(2),z(e!=null&&e.done?-1:12)}}var ge=class r{toastService=l(E);taskService=l(x);elementRef=l(U);task;tasks$=this.taskService.getAll();editTask(t){this.task=t,this.elementRef.nativeElement.querySelector("app-task-form").scrollIntoView({block:"center",behavior:"smooth"})}deleteTask(t){return c(this,null,function*(){try{yield this.taskService.delete(t),this.toastService.show("Task deleted successfully!")}catch{this.toastService.show("Error deleting task")}})}toggleDone(t){return c(this,null,function*(){try{let{id:e,done:i}=t;yield this.taskService.update(e,{done:!i}),this.toastService.show("Task updated successfully!")}catch{this.toastService.show("Error updating task")}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=m({type:r,selectors:[["app-tasks"]],decls:17,vars:8,consts:[[3,"task"],[1,"min-w-full","shadow","rounded-lg","overflow-hidden","mb-10"],[1,"min-w-full","leading-normal"],[1,"px-5","py-3","border-b-2","border-gray-200","bg-gray-100","text-left","text-xs","font-semibold","text-gray-600","uppercase","tracking-wider"],[3,"ngClass"],[1,"px-5","py-5","bg-white","border-t","flex","flex-col","xs:flex-row","items-center","xs:justify-between"],[1,"text-xs","xs:text-sm","text-gray-900"],[1,"px-5","py-5","border-b","border-gray-200","text-sm"],[1,"flex"],["type","checkbox","value","true",1,"flex-shrink-0","h-6","w-6","mt-1",3,"change","checked"],[1,"ml-4"],[1,"text-gray-900","whitespace-no-wrap","font-semibold"],[1,"text-gray-500","whitespace-no-wrap"],[1,"text-gray-400","text-xs","whitespace-no-wrap","py-3"],[1,"flex","gap-3"],[1,"bg-indigo-500","px-4","py-2","rounded-md","text-white","tracking-wide","cursor-pointer",3,"click"],[1,"bg-red-500","px-4","py-2","rounded-md","text-white","tracking-wide","cursor-pointer",3,"click"]],template:function(e,i){if(e&1&&(n(0,"app-web"),k(1,"app-task-form",0),n(2,"div",1)(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),s(7," Tasks "),a()()(),n(8,"tbody"),J(9,Ce,13,11,"tr",4,be),u(11,"async"),u(12,"taskSort"),a()(),n(13,"div",5)(14,"span",6),s(15),u(16,"async"),a()()()()),e&2){let o;p(),f("task",i.task),p(8),K(g(12,4,g(11,2,i.tasks$))),p(6),b(" Showing ",(o=g(16,6,i.tasks$))==null?null:o.length," entries ")}},dependencies:[F,ee,_,te,$,I,P],encapsulation:2})};export{ge as TasksComponent};
